<?xml version="1.0" encoding="ASCII"?>
<forth xmlns="http://forth.org.ru/ForthML/">

<rem><bind-up>
  read-line.f.xml
  read-headers
  parse-request-line
</bind-up></rem>

<def name="read-request-line?" ds=" -- flag ">
  next-line? <unless> FALSE <exit/></unless>
  TEST-EOLN <unless><logS>TEST-EOLN</logS> `#414 STHROW </unless><!-- Request-URI Too Large -->
  FINE-HEAD DUP <unless> 2DROP <again/></unless><!-- skip empty lines -->
  parse-request-line
  http-ver-major 1 EQ <unless>
    `http-request h@ <logS>request line</logS>
    `#505 STHROW 
  </unless><!-- HTTP/1.1 only -->
  TRUE
</def>

<def name="accept-request?" ds=" -- flag ">
  read-request-line? <unless> FALSE <exit/></unless>
  read-headers  TRUE
</def>

</forth>

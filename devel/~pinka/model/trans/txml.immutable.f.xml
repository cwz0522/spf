<?xml version="1.0" encoding="ASCII" ?>
<forth xmlns="http://forth.org.ru/ForthML/">
<!-- Feb.2007 ruvim@forth.org.ru -->

<def name="advice-trule-after" ds=" xt -- ">
  <p><exec>t-slot @</exec> DUP <if><exit/></if> DROP <exec/></p> t-slot !
</def>
<def name="advice-trule-before" ds=" xt -- ">
  <p><exec/> DUP <if><exit/></if> DROP <exec>t-slot @</exec></p> t-slot !
</def>

<def name="trans-node-force" ds="i*x -- i*x | j*x">
  t-slot @ EXECUTE <if><exit/></if> -5001 THROW
</def>

<def name="trans-childs" ds=" i*x -- j*x ">
  cnode >R
  FirstChild <repeat> cnode <while/> trans-node-force NextSibling </repeat>
  R> cnode!
</def>

<def name="trans-document" ds=" doc -- ">
  cnode >R documentElement cnode! trans-childs R> cnode!
</def>

<def name="EMBODY" ds=" i*x url-a url-u -- j*x ">
  DefaultLSParser parseURI DUP 0= <if>-5002 THROW</if>
  DUP >R trans-document R> DefaultLSParser freeDoc
</def>

</forth>
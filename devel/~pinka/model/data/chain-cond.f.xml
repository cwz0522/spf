<?xml version="1.0" encoding="windows-1251" ?>
<forth xmlns="http://forth.org.ru/ForthML/">
<!-- 2007 -->

<!-- require list-plain.f.xml -->

<cell name="chain-current"/>
<cell name="chain-context"/>

<def name="advice-before" ds=" xt -- ">
  0 , HERE SWAP , chain-current @ BIND-NODE
</def>
<def name="advice-after" ds=" xt -- ">
  0 , HERE SWAP , chain-current @ BIND-NODE-TAIL
</def>

<def name="(perform-chain)" ds=" i*x list -- j*x flag ">
  @ <repeat> DUP <while/> DUP >R @ EXECUTE <if> RDROP TRUE <exit/></if> R> CELL- @ </repeat>
  <!-- ( false ) -->
</def>

<def name="perform-chain" ds=" i*x -- j*x flag ">
  chain-context @ DUP <unless><exit/></unless>
  (perform-chain)
  <!-- ( false ) -->
</def>

<def name="perform-chain-sure" ds=" i*x -- j*x ">
  perform-chain <if><exit/></if> ABORT
</def>

</forth>

<?xml version="1.0" encoding="ASCII"?>
<forth xmlns="http://forth.org.ru/ForthML/"
     xmlns:r="http://forth.org.ru/ForthML/Rules/"
    xmlns:tc="http://forth.org.ru/ForthML/TC/"
    xmlns:xi="http://forth.org.ru/ForthML/Struct/"
>

<include href="import-words.f.xml"/>

<xi:model name="tc-guard" href="tc-guard-w.f.xml"/>

<include href="tc-host.f.xml"/>

<develop wordlist="TC-WL">
  <r:extend transform="transformer-fml" >
    <include href="import-words.f.xml"/>
  </r:extend>

  <init>
  300 1024 * ALLOCATED DATASPACE!
  300 1024 * ALLOCATED CODESPACE!
  500 CELLS  ALLOCATED ASSUME-CS
    2 1024 * ALLOCATED ASSUME-PAD
  DECIMAL

  WORDLIST DUP `FORTH-WL NAMING-WORDLIST- DUP PUSH-SCOPE  DUP SET-CURRENT
  DUP MAKE-CONST `FORTH-WL NAMING-
  </init><rem>( wid )</rem>
  <const name="target-root"/>

  <def name="give-forth" ds=" -- ">
    GET-CURRENT target-root APPEND-WORDLIST
  </def>
  <alias name="hcall" word="E-NATIVE-SURE"/>  
</develop>


<text>fix-inlines.f</text> INCLUDED


<r:mode transform="TC-WL::transformer-fml">

  <tc:import from="TC-WL">
    hcall give-forth
    NEXT-LINE-STDIN OK ?STACK
  </tc:import>

  <include href="carcase.f.xml"/>
  <include href="quit.f.xml"/>

  <init><rem> initiate the target system </rem>
    <rem> The host system and the target system are has a same code form! So we can execute a words from the target system.</rem>
    
    `TC-WL::VOC-LIST       hcall    @ VOC-LIST !
    `TC-WL::SAVE-STORAGE   hcall    RESTORE-STORAGE
 
    500 CELLS ALLOCATED ASSUME-CS
    2 1024 *  ALLOCATED ASSUME-PAD
    DECIMAL 
    FORTH-WL DUP SET-CURRENT PUSH-SCOPE
  </init>
</r:mode>

</forth>
